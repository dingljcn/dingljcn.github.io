<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>脚本演化史 | dingljcn</title><meta name="author" content="dingljcn"><meta name="copyright" content="dingljcn"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="如何把油猴脚本一步一步玩出花来">
<meta property="og:type" content="article">
<meta property="og:title" content="脚本演化史">
<meta property="og:url" content="http://dingljcn.github.io/2024/01/01/%E8%84%9A%E6%9C%AC%E6%BC%94%E5%8C%96%E5%8F%B2/index.html">
<meta property="og:site_name" content="dingljcn">
<meta property="og:description" content="如何把油猴脚本一步一步玩出花来">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/tampermonkey.svg">
<meta property="article:published_time" content="2024-01-01T08:28:55.000Z">
<meta property="article:modified_time" content="2024-01-01T08:28:55.000Z">
<meta property="article:author" content="dingljcn">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="script">
<meta property="article:tag" content="vue">
<meta property="article:tag" content="typescript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/tampermonkey.svg"><link rel="shortcut icon" href="https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/favicon.png"><link rel="canonical" href="http://dingljcn.github.io/2024/01/01/%E8%84%9A%E6%9C%AC%E6%BC%94%E5%8C%96%E5%8F%B2/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/pluginsSrc/node-snackbar/dist/snackbar.min.css?v=0.1.16" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.32" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.0',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '脚本演化史',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-01 16:28:55'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/dingljcn.css"><script src="/js/dingljcn.js"></script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/favicon.png" onerror="onerror=null;src='https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background: var(--default-top)"><nav id="nav"><span id="blog-info"><a href="/" title="dingljcn"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/favicon.png"/><span class="site-name">dingljcn</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">脚本演化史<a class="post-edit-link" href="https://github.com/dingljcn/blog.source/edit/main/source/_posts/脚本演化史.md" title="Edited on" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-01-01T08:28:55.000Z" title="Created 2024-01-01 16:28:55">2024-01-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-01-01T08:28:55.000Z" title="Updated 2024-01-01 16:28:55">2024-01-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/javascript/">javascript</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>14mins</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一、第一版"><a href="#一、第一版" class="headerlink" title="一、第一版"></a>一、第一版</h1><p><code>(2022-12-30, R147772)</code>和<code>(2023-04-20, R159295)</code></p>
<p>该阶段的脚本所有代码都写到油猴里, 这一阶段最显著的特征是做一些最基本的元素创建都非常麻烦</p>
<p><strong>部分代码摘要:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="comment">// 创建元素, 设置样式</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">createTitle</span>(<span class="params">title</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> titleDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        titleDiv.<span class="property">innerText</span> = title;</span><br><span class="line">        titleDiv.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;20px 0&#x27;</span>;</span><br><span class="line">        titleDiv.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&#x27;24px&#x27;</span>;</span><br><span class="line">        titleDiv.<span class="property">style</span>.<span class="property">fontWeight</span> = <span class="string">&#x27;bold&#x27;</span>;</span><br><span class="line">        titleDiv.<span class="property">style</span>.<span class="property">textAlign</span> = <span class="string">&#x27;center&#x27;</span>;</span><br><span class="line">        box.<span class="title function_">appendChild</span>(titleDiv);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">drawList</span>(<span class="params">banner, list = [], hasPrev</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (list.<span class="property">length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> box = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;dinglj-case-box&#x27;</span>);</span><br><span class="line">        <span class="comment">// 标题</span></span><br><span class="line">        <span class="keyword">let</span> title = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h2&quot;</span>);</span><br><span class="line">        title.<span class="property">innerText</span> = <span class="string">`<span class="subst">$&#123; banner &#125;</span>(<span class="subst">$&#123; list.length &#125;</span>)`</span>;</span><br><span class="line">        title.<span class="property">style</span>.<span class="property">textAlign</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">        title.<span class="property">style</span>.<span class="property">marginLeft</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">        title.<span class="property">style</span>.<span class="property">marginBottom</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (hasPrev) &#123;</span><br><span class="line">            title.<span class="property">style</span>.<span class="property">marginTop</span> = <span class="string">&#x27;20px&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        box.<span class="title function_">appendChild</span>(title);</span><br><span class="line">        <span class="comment">// 外层容器</span></span><br><span class="line">        <span class="keyword">let</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        container.<span class="property">style</span>.<span class="property">textAlign</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">        box.<span class="title function_">appendChild</span>(container);</span><br><span class="line">        <span class="comment">// 主容器</span></span><br><span class="line">        <span class="keyword">let</span> realContainer = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        realContainer.<span class="property">style</span>.<span class="property">textAlign</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">        realContainer.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0 auto&#x27;</span>;</span><br><span class="line">        realContainer.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;inline-block&#x27;</span>;</span><br><span class="line">        container.<span class="title function_">appendChild</span>(realContainer);</span><br><span class="line">        <span class="comment">// 填充用例信息</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> caseData <span class="keyword">of</span> list) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h1 id="二、第二版"><a href="#二、第二版" class="headerlink" title="二、第二版"></a>二、第二版</h1><p><code>(2023-06-21, R168353)</code></p>
<p>该阶段就已经引入了github仓库</p>
<p>特点：</p>
<ul>
<li>脚本里只需要返回配置信息就行了, 其他执行脚本全部由github上的脚本负责处理</li>
<li>为了让代码执行有先后顺序, 有一个<code>onUtils_Js_Load</code>的函数, 只有当一切都准备好之后, 才会开始获取配置, run起来</li>
<li>虽然已经有了多个js脚本, 但脚本与脚本之间仍通过创建HTML元素建立关联关系, 互相调用</li>
</ul>
<p>解决的痛点：</p>
<ul>
<li>如果主体代码不放到远程仓库, 那么每当我修改的时候, 所有人都需要手动更新, 放到远程仓库后, 只要我将仓库的代码修改, 其他人的也就一并修改了</li>
<li>通用脚本里封装了很多工具函数, 创建元素不那么麻烦了, 也大量使用 HTML.innerHTML &#x3D; ‘’ 的形式进行元素拼接</li>
<li>样式不再局限于行内样式, 或者创建元素时手动设置样式了, 而是和正常的 HTML 一样设置 id 和 class，通过 css 来维护样式, 让代码能更专注于逻辑</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> version = <span class="string">&#x27;release&#x27;</span>; <span class="comment">// release - 正式版; beta - 测试版;</span></span><br><span class="line">    <span class="comment">// 引入远程工具脚本</span></span><br><span class="line">    <span class="keyword">let</span> remoteScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    remoteScript.<span class="property">type</span> = <span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line">    remoteScript.<span class="property">src</span> = <span class="string">`https://dingljcn.github.io/for-boke/<span class="subst">$&#123; version &#125;</span>/index.js?<span class="subst">$&#123; <span class="built_in">Math</span>.random() &#125;</span>`</span>;</span><br><span class="line">    <span class="comment">// 脚本加载完成之后读取开始读配置, 启动脚本</span></span><br><span class="line">    remoteScript.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">onUtils_Js_Load</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> config = &#123;&#125;</span><br><span class="line">            <span class="title function_">run</span>(config);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(remoteScript);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p><strong>远程的部分代码摘要(index.js)</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onUtils_Js_Load, 会去加载一个通用的脚本, 并且只有在通用脚本执行完后才会执行油猴中传入的代码</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onUtils_Js_Load</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> utilScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    utilScript.<span class="property">type</span> = <span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line">    utilScript.<span class="property">src</span> = <span class="string">&#x27;https://dingljcn.github.io/for-boke/release/utils.js?&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">    utilScript.<span class="property">onload</span> = <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(utilScript);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// run 会检查配置合不合法, url 地址是否符合预期, 只有都满足, 才会执行脚本</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">config = <span class="literal">null</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (config == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;未传入配置项, 脚本终止执行&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    context.<span class="property">config</span> = config;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isMatch</span>(context.<span class="property">config</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;传入的配置项: &#x27;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(context.<span class="property">config</span>);</span><br><span class="line">        <span class="title function_">readData</span>();</span><br><span class="line">        <span class="title function_">bindKeyboardEvent</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;当前网址不符合以下匹配规则:&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(context.<span class="property">config</span>.<span class="property">matchList</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>远程的部分代码摘要(utils.js)</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 判断当前网址是否启用脚本 */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isMatch</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">matchList</span>) &#123; <span class="comment">// 如果存在要匹配的网址, 则匹配, 匹配成功才进入</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> stratege <span class="keyword">of</span> config.<span class="property">matchList</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (stratege.<span class="title function_">test</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// 如果没有要匹配的网址, 默认是允许执行脚本</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 到这里说明存在要匹配的网址, 但匹配失败, 返回 false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 向 obj 中添加一个名为 fieldKey 的数组, 并将 data 添加到该数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; obj 被赋值的对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; fieldKey 字段名/属性名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; data 要赋值的值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">pushToProp</span>(<span class="params">obj, fieldKey, data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> list = obj[fieldKey];</span><br><span class="line">    <span class="keyword">if</span> (!list) &#123;</span><br><span class="line">        <span class="comment">// 不存在, 创建</span></span><br><span class="line">        list = [];</span><br><span class="line">        obj[fieldKey] = list;</span><br><span class="line">    &#125;</span><br><span class="line">    list.<span class="title function_">push</span>(data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="三、第三版"><a href="#三、第三版" class="headerlink" title="三、第三版"></a>三、第三版</h1><p><code>(2023-12-14,R201591) </code></p>
<p>该阶段的油猴脚本里做两件事:</p>
<ol>
<li>定义<code>readConfig</code>函数, 返回配置</li>
<li>创建一个<code>module</code>形式的脚本</li>
</ol>
<p>特点：</p>
<ul>
<li>不再需要 utils_Js_Load 这类函数来控制先后, 脚本与脚本之间可以通过 import 的形式进行互动</li>
<li>引入 vue 框架, 像是导航栏、tab页面板、表格、按钮等等，都进行组件化，一处定义，多处使用，且每个脚本中这些组件的外观风格都是统一的，看起来会非常和谐</li>
<li>得益于模块化，代码复杂度断崖式下降，有了更多精力去做更多事，比如右键菜单，比如本地的备注功能，比如置顶功能，以及新变更提醒等等</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">readConfig</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">css</span>: <span class="string">``</span>,</span><br><span class="line">            <span class="attr">whoami</span>: &#123;</span><br><span class="line">                <span class="attr">en</span>: <span class="string">&#x27;dinglj&#x27;</span>,</span><br><span class="line">                <span class="attr">zh</span>: <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">strategy</span>: &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    script.<span class="property">type</span> = <span class="string">&#x27;module&#x27;</span>;</span><br><span class="line">    script.<span class="property">src</span> = <span class="string">`https://dingljcn.github.io/bk-vue/src/script/ticket-list/index.js`</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p><strong>index.js摘要</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入其他脚本</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./read-config.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../../utils/index.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../../entity/GroupStrategy.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vuefilter <span class="keyword">from</span> <span class="string">&#x27;./filter.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> mymodal <span class="keyword">from</span> <span class="string">&#x27;../ticket-modal.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; whoami &#125; <span class="keyword">from</span> <span class="string">&#x27;../ticket-tool.js&#x27;</span>;</span><br><span class="line"><span class="comment">// 链接样式</span></span><br><span class="line">dinglj.<span class="title function_">linkCss</span>(<span class="string">&#x27;assets/css/utils.css&#x27;</span>);</span><br><span class="line">dinglj.<span class="title function_">linkCss</span>(<span class="string">&#x27;assets/css/vue.css&#x27;</span>);</span><br><span class="line">dinglj.<span class="title function_">linkCss</span>(<span class="string">&#x27;src/script/ticket-list/index.css&#x27;</span>);</span><br><span class="line">dinglj.<span class="title function_">injectUserCss</span>();</span><br><span class="line">dinglj.<span class="title function_">remById</span>(<span class="string">&#x27;footer&#x27;</span>);</span><br><span class="line"><span class="comment">// 为Vue做准备</span></span><br><span class="line"><span class="keyword">const</span> mainElement = dinglj.<span class="title function_">byId</span>(<span class="string">&#x27;main&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (mainElement) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> element <span class="keyword">of</span> mainElement.<span class="property">children</span>) &#123;</span><br><span class="line">        element.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    mainElement.<span class="property">innerHTML</span> += <span class="string">`&lt;div id=&quot;dinglj-main&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;navigatorview :list=&quot;groupNames&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;template v-slot:before&gt;</span></span><br><span class="line"><span class="string">                &lt;vuefilter :data=&quot;originData&quot; @on-change=&quot;data =&gt; filter = data&quot;&gt;&lt;/vuefilter&gt;</span></span><br><span class="line"><span class="string">            &lt;/template&gt;</span></span><br><span class="line"><span class="string">            &lt;template class=&quot;result-view&quot; v-slot:content&gt;</span></span><br><span class="line"><span class="string">                &lt;tabpanelview v-for=&quot;groupName in groupNames&quot; :names=&quot;this.tabNames(groupName)&quot;</span></span><br><span class="line"><span class="string">                    :get-name=&quot;k =&gt; k + &#x27;(&#x27; + tabData(groupName)[k].length + &#x27;)&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;TableX v-for=&quot;tabName in tabNames(groupName)&quot;</span></span><br><span class="line"><span class="string">                        :columns=&quot;columnsToDisplay(groupName, tabName)&quot;</span></span><br><span class="line"><span class="string">                        :data=&quot;tabData(groupName)[tabName]&quot;</span></span><br><span class="line"><span class="string">                        :flex-columns=&quot;[&#x27;summary&#x27;]&quot;</span></span><br><span class="line"><span class="string">                        :get-cell=&quot;(t, c) =&gt; getCellValue(t, c)&quot;</span></span><br><span class="line"><span class="string">                        :key=&quot;groupName + tabName + tops.length&quot;</span></span><br><span class="line"><span class="string">                        @on-loaded=&quot;tableLoaded&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;/TableX&gt;</span></span><br><span class="line"><span class="string">                &lt;/tabpanelview&gt;</span></span><br><span class="line"><span class="string">            &lt;/template&gt;</span></span><br><span class="line"><span class="string">            &lt;template v-slot:after&gt;&lt;/template&gt;</span></span><br><span class="line"><span class="string">        &lt;/navigatorview&gt;</span></span><br><span class="line"><span class="string">        &lt;mymodal :display=&quot;modal.display&quot; @on-close=&quot;modal.display = false&quot; :parent=&quot;this&quot; :ticket=&quot;modal.ticket&quot;&gt;&lt;/mymodal&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建Vue程序</span></span><br><span class="line"><span class="title function_">createVue</span>(&#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _that = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">displayData</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _that;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="comment">/**更新概述单元格的内容 */</span></span><br><span class="line">        <span class="title function_">updateSummary</span>(<span class="params">ticket</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">updateSummary</span>(<span class="variable language_">this</span>, ticket);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">computed</span>: &#123;</span><br><span class="line">        <span class="comment">/** 获取用户配置 */</span></span><br><span class="line">        <span class="title function_">config</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="title function_">readConfig</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">components</span>: &#123;</span><br><span class="line">        vuefilter, mymodal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="string">&#x27;#dinglj-main&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>TableX源码</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cell <span class="keyword">from</span> <span class="string">&quot;./cell.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 表格, 传入 [ &#123; label, value &#125; ] 形式的表头列名, 再传入要显示的数据列表即可 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">`&lt;div class=&quot;dinglj-v-table&quot; :id=&quot;id&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;dinglj-v-thead dinglj-v-tr&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;cell v-if=&quot;selectable&quot; class=&quot;dinglj-v-table-select&quot; @click=&quot;doCheckAll&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;checkbox&quot; :checked=&quot;checkAll&quot;/&gt;选择</span></span><br><span class="line"><span class="string">            &lt;/cell&gt;</span></span><br><span class="line"><span class="string">            &lt;cell v-if=&quot;processNum&quot; class=&quot;dinglj-v-table-sequence&quot;&gt;</span></span><br><span class="line"><span class="string">                序号</span></span><br><span class="line"><span class="string">            &lt;/cell&gt;</span></span><br><span class="line"><span class="string">            &lt;cell v-for=&quot;column in columns&quot; :best-width=&quot;bestWidth[getValue(column)]&quot; :class=&quot;getClass(column)&quot;&gt;</span></span><br><span class="line"><span class="string">                &#123;&#123; getLabel(column) &#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;/cell&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;dinglj-v-tbody&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;dinglj-v-tr&quot; v-for=&quot;(line, idx) in data&quot; @click=&quot;checkOne(line)&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;cell v-if=&quot;selectable&quot; class=&quot;dinglj-v-table-select&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;input type=&quot;checkbox&quot; :checked=&quot;checkList.includes(line)&quot;/&gt;</span></span><br><span class="line"><span class="string">                    &lt;/cell&gt;</span></span><br><span class="line"><span class="string">                    &lt;cell v-if=&quot;processNum&quot; class=&quot;dinglj-v-table-sequence&quot;&gt;</span></span><br><span class="line"><span class="string">                        &#123;&#123; idx + 1 &#125;&#125;</span></span><br><span class="line"><span class="string">                    &lt;/cell&gt;</span></span><br><span class="line"><span class="string">                    &lt;cell :best-width=&quot;bestWidth[getValue(column)]&quot; :class=&quot;getClass(column)&quot; v-for=&quot;column in columns&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;dinglj-v-auto-hidden&quot; v-html=&quot;getCell(line, getValue(column))&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/cell&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`</span>,</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">checkAll</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">checkList</span>: [],</span><br><span class="line">            <span class="attr">id</span>: dinglj.<span class="title function_">uuid</span>(<span class="string">&#x27;table-v&#x27;</span>),</span><br><span class="line">            <span class="attr">cache</span>: &#123;</span><br><span class="line">                <span class="attr">bestWidth</span>: &#123;&#125;,</span><br><span class="line">                <span class="attr">cellClass</span>: &#123;&#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.$emit(<span class="string">&#x27;on-loaded&#x27;</span>, <span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">doCheckAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="property">length</span> = <span class="number">0</span>; <span class="comment">// 直接清空</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">checkAll</span>) &#123; <span class="comment">// 当前不是全选, 表示接下来要全选, 全部加入</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="title function_">push</span>(...<span class="variable language_">this</span>.<span class="property">data</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">checkAll</span> = !<span class="variable language_">this</span>.<span class="property">checkAll</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">checkOne</span>(<span class="params">line</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="title function_">includes</span>(line)) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="title function_">remove</span>(line);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">checkAll</span> = <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="title function_">push</span>(line);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="property">length</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">checkAll</span> = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">getClass</span>(<span class="params">column</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cache</span>.<span class="property">cellClass</span>[<span class="variable language_">this</span>.<span class="title function_">getValue</span>(column)]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="property">cellClass</span>[<span class="variable language_">this</span>.<span class="title function_">getValue</span>(column)];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> flex = <span class="variable language_">this</span>.<span class="property">flexColumns</span>.<span class="title function_">includesIgnoreCase</span>(<span class="variable language_">this</span>.<span class="title function_">getValue</span>(column)) ? <span class="string">&#x27;flex&#x27;</span> : <span class="string">&#x27;fixed&#x27;</span>;</span><br><span class="line">            <span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line">            result[<span class="variable language_">this</span>.<span class="title function_">getValue</span>(column)] = <span class="literal">true</span>;</span><br><span class="line">            result[flex] = <span class="literal">true</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="property">cellClass</span>[<span class="variable language_">this</span>.<span class="title function_">getValue</span>(column)] = result;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">computed</span>: &#123;</span><br><span class="line">        <span class="title function_">bestWidth</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line">            <span class="comment">// 一列一列分别计算宽度</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> column <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">columns</span>) &#123;</span><br><span class="line">                <span class="comment">// 计算本列的标题宽度</span></span><br><span class="line">                <span class="keyword">const</span> columnKey = <span class="variable language_">this</span>.<span class="title function_">getValue</span>(column);</span><br><span class="line">                <span class="keyword">const</span> columnTitle = <span class="variable language_">this</span>.<span class="title function_">getLabel</span>(column);</span><br><span class="line">                <span class="keyword">let</span> titleWidth = dinglj.<span class="title function_">calcTxtWidth</span>(columnTitle);</span><br><span class="line">                <span class="keyword">let</span> widthArray = [ titleWidth ];</span><br><span class="line">                <span class="comment">// 计算本列的每一行宽度</span></span><br><span class="line">                widthArray.<span class="title function_">push</span>(</span><br><span class="line">                    ...<span class="variable language_">this</span>.<span class="property">data</span>.<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">const</span> columnContent = <span class="variable language_">this</span>.<span class="title function_">getCell</span>(e, columnKey);</span><br><span class="line">                        <span class="keyword">return</span> dinglj.<span class="title function_">calcTxtWidth</span>(columnContent);</span><br><span class="line">                    &#125;)</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">const</span> maxWidth = <span class="title class_">Math</span>.<span class="title function_">max</span>(...widthArray);</span><br><span class="line">                result[columnKey] = maxWidth + <span class="number">30</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">columns</span>: <span class="title class_">Array</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="title class_">Array</span>,</span><br><span class="line">        <span class="attr">selectable</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">processNum</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">flexColumns</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">            <span class="attr">default</span>: []</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getLabel</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Function</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="function"><span class="params">i</span> =&gt;</span> i.<span class="property">label</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getValue</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Function</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="function"><span class="params">i</span> =&gt;</span> i.<span class="property">value</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getCell</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Function</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="function">(<span class="params">_case_, column</span>) =&gt;</span> <span class="string">&#x27;&#x27;</span> + _case_[column]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">components</span>: &#123;</span><br><span class="line">        cell</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="四、第四版"><a href="#四、第四版" class="headerlink" title="四、第四版"></a>四、第四版</h1><p><code>(研发中)</code></p>
<p>油猴脚本保留第三版的情况下，将仓库中的代码升级至typescript</p>
<p>好处：</p>
<ul>
<li>在TypeScript环境下，代码的出错率、代码提示都会比JavaScript好上很多</li>
<li>自定义装饰器, 摆脱JavaScript中所有代码都写在一个对象里的苦恼, 通过在字段或方法上面增加装饰器, 然后自己写一段自动组装成传统vue对象的代码，达到与JavaScript中相同的效果</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../../init&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">linkCss</span>(<span class="string">&#x27;\\case-list\\index.css&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="string">`&lt;div id=&quot;case-list-dinglj-container&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;i-button&gt;导出&lt;/i-button&gt;</span></span><br><span class="line"><span class="string">    &#123;&#123; h1 &#125;&#125;</span></span><br><span class="line"><span class="string">    &lt;i-button&gt;刷新&lt;/i-button&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    &lt;i-input caption=&quot;关键字&quot; placeholder=&quot;请输入关键字&quot;&gt;&lt;/i-input&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    &lt;i-switch pre-text=&quot;卡片&quot; post-text=&quot;表格&quot;&gt;&lt;/i-switch&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;`</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">defunc</span>(<span class="string">&#x27;uuid&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">createVue</span>(&#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">h1</span>: <span class="variable language_">window</span>.<span class="title function_">uuid</span>(<span class="string">&#x27;哈哈哈&#x27;</span>, <span class="number">5</span>),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;, <span class="string">&#x27;#case-list-dinglj-container&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>更规范的做原型链拓展，完善代码提示</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">global</span> &#123;</span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">String</span> &#123;</span><br><span class="line">        <span class="comment">/** 忽略大小写判断字符串是否相等 */</span></span><br><span class="line">        <span class="title function_">equalsIgnoreCase</span>(<span class="attr">another</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>,</span><br><span class="line">        <span class="comment">/** 忽略大小写判断是否有子串 */</span></span><br><span class="line">        <span class="title function_">includesIgnoreCase</span>(<span class="attr">another</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>,</span><br><span class="line">        <span class="comment">/** 在界面上输出提示信息 */</span></span><br><span class="line">        <span class="title function_">info</span>(): <span class="built_in">void</span>,</span><br><span class="line">        <span class="comment">/** 在界面上输出警告信息 */</span></span><br><span class="line">        <span class="title function_">warn</span>(): <span class="built_in">void</span>,</span><br><span class="line">        <span class="comment">/** 在界面上输出错误信息 */</span></span><br><span class="line">        <span class="title function_">err</span>(): <span class="built_in">void</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>按钮的通用组件源码</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AbstractComponent</span>, <span class="title class_">ComponentType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../../entity&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Method</span>, <span class="title class_">Mounted</span>, <span class="title class_">Prop</span>, <span class="title class_">Template</span> &#125; <span class="keyword">from</span> <span class="string">&quot;..&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ButtonX</span> <span class="keyword">extends</span> <span class="title class_ inherited__">AbstractComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mounted</span>(<span class="string">&#x27;I-Button&#x27;</span>, <span class="title class_">ComponentType</span>.<span class="property">ButtonX</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">vid</span> = <span class="variable language_">window</span>.<span class="title function_">uuid</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Template</span></span><br><span class="line">    <span class="attr">template</span>: <span class="built_in">string</span> = <span class="string">`&lt;div :class=&quot;getClass()&quot; :id=&quot;vid&quot; :style=&quot;getStyle()&quot; @click=&quot;$emit(&#x27;on-click&#x27;)&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;slot&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Prop</span>(<span class="title class_">String</span>, <span class="string">&#x27;normal&#x27;</span>)</span><br><span class="line">    <span class="attr">xSize</span>: <span class="string">&#x27;small&#x27;</span> | <span class="string">&#x27;normal&#x27;</span> | <span class="string">&#x27;big&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Prop</span>(<span class="title class_">String</span>, <span class="string">&#x27;primary&#x27;</span>)</span><br><span class="line">    <span class="attr">xType</span>: <span class="string">&#x27;primary&#x27;</span> | <span class="string">&#x27;warn&#x27;</span> | <span class="string">&#x27;error&#x27;</span> | <span class="string">&#x27;cancel&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Method</span></span><br><span class="line">    <span class="title function_">getClass</span>(): <span class="built_in">object</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;dinglj-v-btn&#x27;</span>: <span class="literal">true</span>, </span><br><span class="line">            <span class="string">&#x27;dinglj-v-ctl&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;primary&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xType</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;primary&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;cancel&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xType</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;cancel&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;warn&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xType</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;warn&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xType</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;error&#x27;</span>),</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Method</span></span><br><span class="line">    <span class="title function_">getStyle</span>(): <span class="built_in">object</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;--height&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xSize</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;small&#x27;</span>) ? <span class="string">&#x27;24px&#x27;</span> : (<span class="variable language_">this</span>.<span class="property">xSize</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;normal&#x27;</span>) ? <span class="string">&#x27;28px&#x27;</span> : <span class="string">&#x27;32px&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;--margin-tb&#x27;</span>: <span class="variable language_">this</span>.<span class="property">xSize</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;small&#x27;</span>) ? <span class="string">&#x27;1px&#x27;</span> : (<span class="variable language_">this</span>.<span class="property">xSize</span>.<span class="title function_">equalsIgnoreCase</span>(<span class="string">&#x27;normal&#x27;</span>) ? <span class="string">&#x27;2px&#x27;</span> : <span class="string">&#x27;3px&#x27;</span>),</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/javascript/">javascript</a><a class="post-meta__tags" href="/tags/script/">script</a><a class="post-meta__tags" href="/tags/vue/">vue</a><a class="post-meta__tags" href="/tags/typescript/">typescript</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/01/01/Hexo%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E9%83%A8%E7%BD%B2/" title="Hexo博客教程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/dingljcn/img.repo/master/article/image-20231231141107999.png" onerror="onerror=null;src='https://raw.githubusercontent.com/dingljcn/img.repo/master/gitpage/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Hexo博客教程</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%AC%AC%E4%B8%80%E7%89%88"><span class="toc-text">一、第一版</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%AC%AC%E4%BA%8C%E7%89%88"><span class="toc-text">二、第二版</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%AC%AC%E4%B8%89%E7%89%88"><span class="toc-text">三、第三版</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%AC%AC%E5%9B%9B%E7%89%88"><span class="toc-text">四、第四版</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By dingljcn</div><div class="footer_custom_text">A ERP Developer from China</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.32"></script><script src="/pluginsSrc/instant.page/instantpage.js?v=5.2.0" type="module"></script><script src="/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js?v=17.8.5"></script><script src="/pluginsSrc/node-snackbar/dist/snackbar.min.js?v=0.1.16"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('/pluginsSrc/pangu/dist/browser/pangu.min.js?v=4.0.7')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js?v=1.1.3"></script></div></body></html>